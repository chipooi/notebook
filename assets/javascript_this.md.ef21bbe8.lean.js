import{o as n,c as s,b as a,d as t}from"./app.6ae31f14.js";const o='{"title":"普通函数中的 this","description":"","frontmatter":{},"headers":[{"level":2,"title":"普通函数中的 this","slug":"普通函数中的-this"},{"level":2,"title":"箭头函数中的 this","slug":"箭头函数中的-this"},{"level":2,"title":"通过 bind 等 API 改变 this 指向","slug":"通过-bind-等-api-改变-this-指向"}],"relativePath":"javascript/this.md","lastUpdated":1622120243467}',c={},l=a("h2",{id:"普通函数中的-this"},[a("a",{class:"header-anchor",href:"#普通函数中的-this","aria-hidden":"true"},"#"),t(" 普通函数中的 this")],-1),e=a("div",{class:"language-js"},[a("pre",null,[a("code",null,[a("span",{class:"token keyword"},"function"),t(),a("span",{class:"token function"},"foo"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),t(),a("span",{class:"token punctuation"},"{"),t("\n  console"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"log"),a("span",{class:"token punctuation"},"("),a("span",{class:"token keyword"},"this"),a("span",{class:"token punctuation"},","),t(),a("span",{class:"token keyword"},"this"),a("span",{class:"token punctuation"},"."),t("a"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),t("\n"),a("span",{class:"token punctuation"},"}"),t("\n"),a("span",{class:"token keyword"},"var"),t(" a "),a("span",{class:"token operator"},"="),t(),a("span",{class:"token number"},"1"),a("span",{class:"token punctuation"},";"),t("\n"),a("span",{class:"token function"},"foo"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),t(),a("span",{class:"token comment"},"// window 1"),t("\n\n"),a("span",{class:"token keyword"},"const"),t(" obj "),a("span",{class:"token operator"},"="),t(),a("span",{class:"token punctuation"},"{"),t("\n  a"),a("span",{class:"token operator"},":"),t(),a("span",{class:"token number"},"2"),a("span",{class:"token punctuation"},","),t("\n  foo"),a("span",{class:"token operator"},":"),t(" foo\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},";"),t("\nobj"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"foo"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),t(),a("span",{class:"token comment"},"// obj 2"),t("\n\n"),a("span",{class:"token keyword"},"const"),t(" c "),a("span",{class:"token operator"},"="),t(),a("span",{class:"token keyword"},"new"),t(),a("span",{class:"token class-name"},"foo"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),t(),a("span",{class:"token comment"},"// foo() undefined"),t("\n")])])],-1),p=a("ul",null,[a("li",null,[t("对于直接调用 foo 函数来说，不管 foo 函数被放在哪个地方，"),a("code",null,"this"),t(" 一定是 window")]),a("li",null,[t("对于 obj.foo()来说，我们只需要记住，谁调用了函数，谁就是 "),a("code",null,"this"),t("，所以在这个场景下 foo 函数中的 "),a("code",null,"this"),t(" 就是 obj 对象")]),a("li",null,[t("对于 "),a("code",null,"new"),t(" 的方式来说，"),a("code",null,"this"),t(" 被永远绑定在了 "),a("code",null,"c"),t(" 上面，不会被任何方式改变 "),a("code",null,"this")])],-1),u=a("h2",{id:"箭头函数中的-this"},[a("a",{class:"header-anchor",href:"#箭头函数中的-this","aria-hidden":"true"},"#"),t(" 箭头函数中的 this")],-1),i=a("div",{class:"language-js"},[a("pre",null,[a("code",null,[a("span",{class:"token keyword"},"function"),t(),a("span",{class:"token function"},"a"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),t(),a("span",{class:"token punctuation"},"{"),t("\n  "),a("span",{class:"token keyword"},"return"),t(),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),t(),a("span",{class:"token operator"},"=>"),t(),a("span",{class:"token punctuation"},"{"),t("\n    "),a("span",{class:"token keyword"},"return"),t(),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),t(),a("span",{class:"token operator"},"=>"),t(),a("span",{class:"token punctuation"},"{"),t("\n      console"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"log"),a("span",{class:"token punctuation"},"("),a("span",{class:"token keyword"},"this"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),t("\n    "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},";"),t("\n  "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},";"),t("\n"),a("span",{class:"token punctuation"},"}"),t("\nconsole"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"log"),a("span",{class:"token punctuation"},"("),a("span",{class:"token function"},"a"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),t(),a("span",{class:"token comment"},"// window"),t("\n")])])],-1),k=a("p",null,[t("首先，箭头函数本身是没有 "),a("code",null,"this"),t(" 的，箭头函数的 "),a("code",null,"this"),t(" 只取决于包裹箭头函数的第一个普通函数的 "),a("code",null,"this"),t("。 在这个例子中，因为包裹箭头函数的第一个普通函数是 "),a("code",null,"a"),t("，所以此时的"),a("code",null,"this"),t("是"),a("code",null,"window"),t("。 另外，对箭头函数使用"),a("code",null,"bind"),t("这类函数是无效的。")],-1),d=a("h2",{id:"通过-bind-等-api-改变-this-指向"},[a("a",{class:"header-anchor",href:"#通过-bind-等-api-改变-this-指向","aria-hidden":"true"},"#"),t(" 通过 bind 等 API 改变 this 指向")],-1),r=a("div",{class:"language-js"},[a("pre",null,[a("code",null,[a("span",{class:"token keyword"},"let"),t(" a "),a("span",{class:"token operator"},"="),t(),a("span",{class:"token punctuation"},"{"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},";"),t("\n"),a("span",{class:"token keyword"},"let"),t(),a("span",{class:"token function-variable function"},"fn"),t(),a("span",{class:"token operator"},"="),t(),a("span",{class:"token keyword"},"function"),t(),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),t(),a("span",{class:"token punctuation"},"{"),t("\n  console"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"log"),a("span",{class:"token punctuation"},"("),a("span",{class:"token keyword"},"this"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),t("\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},";"),t("\n"),a("span",{class:"token function"},"fn"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"bind"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"bind"),a("span",{class:"token punctuation"},"("),t("a"),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},";"),t(),a("span",{class:"token comment"},"// => window"),t("\n")])])],-1),f=a("p",null,"为什么上面的代码会输出 window 呢，我们可以将上述代码转换成另外一种形式来看",-1),h=a("div",{class:"language-js"},[a("pre",null,[a("code",null,[a("span",{class:"token keyword"},"let"),t(),a("span",{class:"token function-variable function"},"fn2"),t(),a("span",{class:"token operator"},"="),t(),a("span",{class:"token keyword"},"function"),t(),a("span",{class:"token function"},"fn1"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"{"),t("\n    "),a("span",{class:"token keyword"},"return"),t(),a("span",{class:"token function"},"funtion"),t(),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),a("span",{class:"token punctuation"},"{"),t("\n        "),a("span",{class:"token function"},"fn"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"apply"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),t("\n    "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"apply"),a("span",{class:"token punctuation"},"("),t("a"),a("span",{class:"token punctuation"},")"),t("\n"),a("span",{class:"token punctuation"},"}"),t("\n"),a("span",{class:"token function"},"fn2"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),t("\n")])])],-1),w=a("p",null,[t("从上面的代码中我们可以看到，无论我们给函数"),a("code",null,"bind"),t("几次，fn 中的 "),a("code",null,"this"),t(" 永远由第一次"),a("code",null,"bind"),t("决定，所以结果永远是"),a("code",null,"window"),t("。")],-1),b=a("p",null,[t("以上就是 "),a("code",null,"this"),t(" 的规则了，但是可能会发生多个规则同时出现的情况，这时候不同的规则之间会根据优先级最高的来决定 "),a("code",null,"this"),t(" 的指向。 优先级："),a("strong",null,"new"),t("的优先级最高，接下来是 "),a("code",null,"bind"),t(" 这些函数，然后是 "),a("code",null,"obj.foo()"),t(" 这种对象调用函数的方式，最后是 "),a("code",null,"foo()"),t("这种函数直接调用的方式；同时，箭头函数的 "),a("code",null,"this"),t(" 一旦被绑定就不会再被任何方式改变。")],-1),g=a("p",null,[a("img",{src:"/notebook/assets/image-20210527205539459.216aba19.png",alt:"image-20210527205539459"})],-1);c.render=function(a,t,o,c,m,y){return n(),s("div",null,[l,e,p,u,i,k,d,r,f,h,w,b,g])};export default c;export{o as __pageData};
